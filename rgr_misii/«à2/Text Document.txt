Для решения данной задачи, мы можем использовать логические уравнения, чтобы выразить условия, указанные в задаче. Затем, используя эти уравнения, мы сможем вычислить итоговые оценки для каждого школьника.

Условие "если кто-то из них получает подряд две четверки или две тройки, то дальше он учится кое-как и получает тройку" означает, что если две предыдущие оценки были 4 или 3, то следующая оценка будет равна 3.

Условие "если он получает подряд две пятерки, то совсем перестает заниматься и получает двойку" означает, что если две предыдущие оценки были 5, то следующая оценка будет равна 2.

Условие "если он получает две разные оценки, то следующей будет большая из них" означает, что если две предыдущие оценки были разными, то следующая оценка будет равна большей из них.

Используя эти условия, мы можем выражать оценки каждого школьника в виде логических уравнений и находить их итоговые оценки:

Алексей:
A1 = 4, A2 = 5

A3 = 3, если (A1 = 4 или A1 = 3) и (A2 = 4 или A2 = 3)
и (A1 ≠ 5 и A2 ≠ 5)

A4 = 2, если A1 = 5 и A2 = 5

Александр:
B1 = 2, B2 = 4

B3 = 4, если (B1 = 4 или B1 = 3) и (B2 = 4 или B2 = 3)
и (B1 ≠ 5 и B2 ≠ 5)

B4 = 3, если B1 ≠ B2 и (B1 = 4 или B2 = 4)

Леонид:
C1 = 3, C2 = 2

C3 = 2, если C1 = 5 и C2 = 5

C4 = 3, если (C1 = 4 или C1 = 3) и (C2 = 4 или C2 = 3)
и (C1 ≠ 5 и C2 ≠ 5)

Применяя эти уравнения для каждого школьника, мы можем найти итоговые оценки за полугодие.